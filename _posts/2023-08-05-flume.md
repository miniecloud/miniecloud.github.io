---
title: ë¹…ë°ì´í„° ìˆ˜ì§‘1 - Flume ì„¤ì¹˜
author: mini
date: 2023-08-05 11:50:00 +0800
categories: [Etc, Data Engineering]
tags: [data engineering, flume]
toc : true
mermaid : true
---

## Flume êµ¬ì„±

```mermaid
graph LR;
A[Source]-->B[Interceptor];
	B-->C[Channel];
	C-->D[Sink];
```

- Source : ë‹¤ì–‘í•œ ì›ì²œ ì‹œìŠ¤í…œì—ì„œ ë°ì´í„°ë¥¼ë¡œë“œ
- Interceptor : ë°ì´í„° í•„í„°ë§ ë° ê°€ê³µí•˜ëŠ” ì»´í¬ë„ŒíŠ¸(ìƒëµ ê°€ëŠ¥)
- Channel : Sourceì™€ Sinkë¥¼ ì—°ê±¸(ì„ì‹œì €ì¥)
  - Memory channels :  ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ ìƒì— ì¤‘ê°„ ì ì¬í•˜ë¯€ë¡œ ì„±ëŠ¥ì´ ë†’ì§€ë§Œ ì•ˆì „ì„±ì´ ë‚®ìŒ
  - File Channels : ì „ì†¡í•œ ë°ì´í„°ë¥¼ ë°›ì•„ ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì¸ dataDirsì— ì„ì‹œë¡œ ì €ì¥í–ˆë‹¤ê°€ ì „ì†¡. ì„±ëŠ¥ì€ ë‚®ì§€ë§Œ ì•ˆì „ì„±ì´ ë†’ìŒ
- Sink :  Channelë¡œ ë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ìµœì¢… ëª©ì ì§€ì— ì ì¬
- agent :  ìœ„ ì „ê³¼ì •ìœ¼ë¡œ êµ¬ì„±ëœ ì‘ì—…ë‹¨ìœ„ë¡œ ë…ë¦½ëœ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±



## Flume ì„¤ì¹˜
### 1. flume ì„¤ì¹˜
```
sudo wget https://downloads.apache.org/flume/1.11.0/apache-flume-1.11.0-bin.tar.gz

sudo tar -xzvf apache-flume-1.11.0-bin.tar.gz -C /usr/local
```

### 2. í™˜ê²½ì„¤ì •
1. ~/.bashrc
```
export FLUME_HOME=/usr/local/flume
export PATH=$PATH:$FLUME_HOME/bin
export CLASSPATH=$CLASSPATH:$FLUME_HOME/lib/*.jar
```
2. $FLUME_HOME/conf/flume-env.sh
```
export JAVA_HOME=/usr/lib/jvm/java
```

### 3. ì—ì´ì „íŠ¸ ìƒì„±

$FLUME_HOME/conf/flume-conf.properties

```
# í”ŒëŸ¼ ì—ì´ì „íŠ¸ì—ì„œ ì‚¬ìš©í•  source, channels, sink ê° ë¦¬ì†ŒìŠ¤ ë³€ìˆ˜ ì •ì˜
agent_name.sources = source_name
agent_name.sinks = sink_name
agent_name.channels = channel_name

# Source íƒ€ì… ì§€ì •
- spooldir = íŠ¹ì • ë””ë ‰í„°ë¦¬ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ë‹¤ê°€ ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒê¸°ë©´ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•´ì„œ batchsize ë§Œí¼ ì±„ë„ë¡œ ì „ì†¡
- exec = í”ŒëŸ¼ ì™¸ë¶€ì—ì„œ ìˆ˜í–‰í•œ ëª…ë ¹ì˜ ê²°ê³¼ë¥¼ í”ŒëŸ¼ Event ë¡œ ê°€ì ¸ì™€ ìˆ˜ì§‘í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì œê³µ

# interceptor ì¶”ê°€

# Channel ì§€ì •
- memory = Sourceë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ ì¤‘ê°„ì— ì ì¬í•˜ë¯€ë¡œ ì„±ëŠ¥ì´ ë†’ì§€ë§Œ ì•ˆì „ì„±ì´ ë‚®ìŒ
- file = Sourceì—ì„œ ì „ì†¡í•œ ë°ì´í„°ë¥¼ ë°›ì•„ ë¡œì»¬ì‹œìŠ¤í…œ ê²½ë¡œì¸ dataDirsì— ì„ì‹œ ì €ì¥í–ˆë‹¤ê°€ Sinkë¡œ ì „ë‹¬. ì„±ëŠ¥ì€ ë‚®ì§€ë§Œ ì•ˆì „ì„±ì´ ë†’ìŒ

# ì†ŒìŠ¤ì™€ ì‹±í¬ë¥¼ ì±„ë„ì— ë°”ì¸ë”©
agent_name.sources.source_name.channels = channel_name
agent_name.sinks.sink_name.channels = channel_name
```

### 4. flume agent ì‹¤í–‰
```
flume-ng agent --conf conf --conf-file ../conf/flume-conf-02.properties --name ServiceCarAgent -Dflume.root.logger=INFO, console
```

ğŸ›‘
![flume-log4j](/assets/img/posts/flume-log4j.png)
maven ì‚¬ìš©ì‹œ ì œì™¸ì‹œì¼œì£¼ë©´ ëœë‹¤ê³  í•˜ëŠ”ë° mavenì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì„œ ë‘˜ì¤‘ì— í•˜ë‚˜ ì‚­ì œí–ˆë‹¤. ë‹¤í–‰íˆ ì˜ ë™ì‘í–ˆë‹¤.
<br/><br/>
<br/><br/>


---------------------------------------------
ì¶œì²˜ ë° ì°¸ê³ ìë£Œ<br/>
âŒœì‹¤ë¬´ë¡œ ë°°ìš°ëŠ” ë¹…ë°ì´í„° ê¸°ìˆ âŒŸ <br/>
[tutorial](https://www.tutorialspoint.com/apache_flume/apache_flume_quick_guide.htm)

